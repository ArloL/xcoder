<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.7.5
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>XCoder</h1>

<p>Taking the pain out of scripting and automating xcode builds.</p>

<p>Xcoder is a ruby wrapper around various Xcode tools as well as providing project and workspace parsing and partial write support.  Xcoder also supports manipulation of keychains, packaging and uploading artifacts to <a href="http://testflightapp.com">Testflight</a> and provisioning profile management.</p>

<p>Full documentation can be found here: <a href="http://rayh.github.com/xcoder/">http://rayh.github.com/xcoder/</a></p>

<h2>Requirements</h2>

<p>Xcoder assumes you are using XCode 4.6 on Mountain Lion and ruby 1.9.  You may have some degree of success with lesser versions, but they are not intentionally supported.</p>

<h2>Example Usage</h2>

<p>You will need to install the gem:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_xcoder'>xcoder</span>
</code></pre>

<p>and then require the gem in your project/rakefile/etc</p>

<pre class="code ruby"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>xcoder</span><span class='tstring_end'>'</span></span>
</code></pre>

<h3>Load a project</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_project'>project</span> <span class='op'>=</span> <span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>MyProject</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>  <span class='comment'># Can be the name, the file (e.g. MyProject.xcodeproj) or the path
</span></code></pre>

<h3>Finding all projects from the current directory down</h3>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_find_projects'>find_projects</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span>
</code></pre>

<h3>Find a configuration for a target on a project</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='symbol'>:MyProject</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span><span class='lparen'>(</span><span class='symbol'>:Target</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='lparen'>(</span><span class='symbol'>:Debug</span><span class='rparen'>)</span>   <span class='comment'># returns an Xcode::Configuration object
</span></code></pre>

<h3>Building a configuration</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='symbol'>:MyProject</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span><span class='lparen'>(</span><span class='symbol'>:Target</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='lparen'>(</span><span class='symbol'>:Debug</span><span class='rparen'>)</span>
<span class='id identifier rubyid_builder'>builder</span> <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_builder'>builder</span>
<span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_profile'>profile</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Profiles/MyAdHoc.mobileprovision</span><span class='tstring_end'>'</span></span>    <span class='comment'># This will remove old profiles and install the profile
</span><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_identity'>identity</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>iPhone Developer: Ray Hilton</span><span class='tstring_end'>'</span></span>       <span class='comment'># The name of the identity to use to sign the IPA (optional)
</span><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_clean'>clean</span>
<span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span>
<span class='comment'># Building uses the targets's default sdk, which you can override:
</span><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span> <span class='symbol'>:sdk</span> <span class='op'>=&gt;</span> <span class='symbol'>:iphonesimulator</span>
</code></pre>

<h3>Working with Keychains</h3>

<p>You will not normally need to worry about manipulating keychains unless you want to automate importing of certificates (in a CI system with many clients) or opening of specific keychains for different builds (the old two-certs-with-same-identity-name workaround).</p>

<p>You can either use the user&#39;s login keychain, another named keychain, or simply use a temporary keychain that will be blown away after the build.</p>

<h4>Creating a temporary keychain</h4>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='op'>::</span><span class='const'>Keychain</span><span class='period'>.</span><span class='id identifier rubyid_temp'>temp</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_keychain'>keychain</span><span class='op'>|</span>
    <span class='comment'># import certs into the keychain
</span>    <span class='comment'># perform builds within this keychain's context
</span><span class='kw'>end</span> <span class='comment'># Keychain is deleted
</span></code></pre>

<p>Or, you can create a temporary keychain that will be deleted when the process exits:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_keychain'>keychain</span> <span class='op'>=</span> <span class='const'>Xcode</span><span class='op'>::</span><span class='const'>Keychain</span><span class='period'>.</span><span class='id identifier rubyid_temp'>temp</span>
</code></pre>

<h4>Importing a certificate</h4>

<p>You can import a certificate from a .p12 file into a keychain.  Here we simply create a temporary keychain, import a certificate, set the identity onto the builder and then perform a build.</p>

<pre class="code ruby"><code><span class='id identifier rubyid_keychain'>keychain</span><span class='period'>.</span><span class='id identifier rubyid_import'>import</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Certs/MyCert.p12</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>mycertpassword</span><span class='tstring_end'>'</span></span>
<span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_keychain'>keychain</span> <span class='op'>=</span> <span class='id identifier rubyid_keychain'>keychain</span>                     <span class='comment'># Tell the builder to use the temp keychain
</span><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_identity'>identity</span> <span class='op'>=</span> <span class='id identifier rubyid_keychain'>keychain</span><span class='period'>.</span><span class='id identifier rubyid_identities'>identities</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>    <span class='comment'># Get the first (only) identity name from the keychain
</span></code></pre>

<h3>Packaging a built .app</h3>

<p>After performing the above build, you can create a versioned, well named .ipa and .dSYM.zip</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_package'>package</span>
</code></pre>

<p>This will produce something like: MyProject-Debug-1.0.ipa and MyProject-Debug-1.0.dSYM.zip</p>

<h3>Incrementing the build number</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_info_plist'>info_plist</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_info'>info</span><span class='op'>|</span>
  <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>+</span> <span class='int'>1</span>
  <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
<span class='kw'>end</span>
</code></pre>

<h3>Managing build numbers more efficiently</h3>

<p>Based on our experience we suggest <a href="https://github.com/dazuma/versionomy">Versionomy</a> to manage version numbers. 
Although the marketing version is usually set by hand on release, 
there are situations where it could be nice to have an incremental build number in the marketing version number as well.
The following is an example that takes a marketing version number in the x.y.z format and increments the last part of it.</p>

<pre class="code ruby"><code><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_info_plist'>info_plist</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_info'>info</span><span class='op'>|</span>
  <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>+</span> <span class='int'>1</span>
  <span class='id identifier rubyid_marketing_version'>marketing_version</span> <span class='op'>=</span> <span class='const'>Versionomy</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_marketing_version'>marketing_version</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_marketing_version'>marketing_version</span> <span class='op'>=</span> <span class='id identifier rubyid_marketing_version'>marketing_version</span><span class='period'>.</span><span class='id identifier rubyid_bump'>bump</span><span class='lparen'>(</span><span class='symbol'>:tiny</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
<span class='kw'>end</span>
</code></pre>

<p>You can read more about Versionomy at their <a href="https://github.com/dazuma/versionomy">site</a></p>

<h3>Working with workspaces</h3>

<p>Loading workspaces can be done in a similar way to projects:</p>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_workspaces'>workspaces</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_w'>w</span><span class='op'>|</span>
  <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_describe'>describe</span>                                <span class='comment'># prints a recursive description of the
</span>                                            <span class='comment'># structure of the workspace and its projects
</span><span class='kw'>end</span>
</code></pre>

<p>Or, if you know the name:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_workspace'>workspace</span> <span class='op'>=</span> <span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_workspace'>workspace</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>MyWorkspace</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>  <span class='comment'># Can be the name, the file (e.g. MyWorkspace.xcworkspace) or the path
</span></code></pre>

<h3>Schemes</h3>

<p>There is basic support for schemes, you can enumerate them from a project like so:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_schemes'>schemes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span>
<span class='kw'>end</span>
</code></pre>

<p>Or, access them by name:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_scheme'>scheme</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>MyScheme</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_builder'>builder</span>
</code></pre>

<p>Note: The builder behaves the same as the builder for the target/config approach and will force xcodebuild to use the local build/ directory (as per xcode3) rather than a generated temporary directory in DerivedData.  This may or may not be a good thing.</p>

<p>Note: Shared schemes and user (current logged in user) specific schemes are both loaded. They may share names and other similarities that make them hard to distinguish. Currently the priority loading order is shared schemes and then user specific schemes.</p>

<h3>Provisioning profiles</h3>

<p>The library provides a mechanism to install/uninstall a provisioning profile.  This normally happens as part of a build (if a profile is provided to the builder, see above), but you can do this manually:</p>

<pre class="code ruby"><code><span class='comment'># installs profile into ~/Library
</span><span class='const'>Xcode</span><span class='op'>::</span><span class='const'>ProvisioningProfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Myprofile.mobileprovision</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_install'>install</span> 
</code></pre>

<p>Or enumerate installed profiles:</p>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='op'>::</span><span class='const'>ProvisioningProfile</span><span class='period'>.</span><span class='id identifier rubyid_installed_profiles'>installed_profiles</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span>
    <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_uninstall'>uninstall</span>     <span class='comment'># Removes the profile from ~/Library/
</span><span class='kw'>end</span>
</code></pre>

<h3>Deployment</h3>

<h4><a href="http://testflightapp.com">Testflight</a></h4>

<p>The common output of this build/package process is to upload to Testflight.  This is pretty simple with Xcoder:</p>

<pre class="code ruby"><code><span class='comment'># Optionally do this, saves doing it again and again
</span><span class='const'>Xcode</span><span class='op'>::</span><span class='const'>Deploy</span><span class='op'>::</span><span class='const'>Testflight</span><span class='period'>.</span><span class='id identifier rubyid_defaults'>defaults</span> <span class='symbol'>:api_token</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>some api token</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:team_token</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>team token</span><span class='tstring_end'>'</span></span>

<span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_deploy'>deploy</span> <span class='symbol'>:testflight</span><span class='comma'>,</span>
    <span class='symbol'>:api_token</span>  <span class='op'>=&gt;</span> <span class='const'>API_TOKEN</span><span class='comma'>,</span> 
    <span class='symbol'>:team_token</span> <span class='op'>=&gt;</span> <span class='const'>TEAM_TOKEN</span><span class='comma'>,</span>
    <span class='symbol'>:notes</span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>some release notes</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:notify</span>     <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>        <span class='comment'># Whether to send a notification to users, default is true
</span>    <span class='symbol'>:lists</span>      <span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AList</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>    <span class='comment'># The lists to distribute the build to
</span></code></pre>

<p>You can also optionally set the HTTP_PROXY environment variable.</p>

<h4>Deploying to Amazon S3</h4>

<p>You can upload the output ipa to an arbitrary buckey on S3</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_deploy'>deploy</span> <span class='symbol'>:s3</span><span class='comma'>,</span> 
    <span class='symbol'>:bucket</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mybucket</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> 
    <span class='symbol'>:access_key_id</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>access id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> 
    <span class='symbol'>:secret_access_key</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>access key</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> 
    <span class='symbol'>:dir</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>options/path/within/bucket</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<h4>Deploying to a web server (SSH)</h4>

<p>The output of the build/package process can be deployed to a remote web server.
You can use SSH with the following syntax:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_deploy'>deploy</span> <span class='symbol'>:ssh</span><span class='comma'>,</span> 
    <span class='symbol'>:host</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mywebserver.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> 
    <span class='symbol'>:username</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>myusername</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> 
    <span class='symbol'>:password</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mypassword</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> 
    <span class='symbol'>:dir</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/var/www/mywebserverpath</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:base_url</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://mywebserver.com/</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<h4>Deploying to a web server (FTP)</h4>

<p>The output of the build/package process can be deployed to a remote web server.
You can upload the files through FTP with the following syntax:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_deploy'>deploy</span> <span class='symbol'>:ftp</span><span class='comma'>,</span> 
    <span class='symbol'>:host</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ftp.mywebserver.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> 
    <span class='symbol'>:username</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>myusername</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> 
    <span class='symbol'>:password</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mypassword</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> 
    <span class='symbol'>:dir</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/mywebserverpath</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:base_url</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://mywebserver.com/</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<h3>OCUnit to JUnit reports</h3>

<p>You can invoke your test target/bundle from the builder</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_test'>test</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_report'>report</span><span class='op'>|</span>
    <span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='op'>=</span> <span class='kw'>false</span>    <span class='comment'># default false, set to true to see raw output from xcodebuild
</span>
    <span class='comment'># The following is the default setup, you wouldnt normally need to do this unless
</span>    <span class='comment'># you want to add new formatters
</span>    <span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_formatters'>formatters</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_add_formatter'>add_formatter</span> <span class='symbol'>:junit</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>test-reports</span><span class='tstring_end'>'</span></span> <span class='comment'># Output JUnit format results to test-reports/
</span>    <span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_add_formatter'>add_formatter</span> <span class='symbol'>:stdout</span>                <span class='comment'># Output a simplified output to STDOUT
</span><span class='kw'>end</span>
</code></pre>

<p>This will invoke the test target, capture the output and write the junit reports to the test-reports directory.  Currently only junit is supported, although you can write your own formatter quite easily (for an example, look at Xcode::Test::Formatters::JunitFormatter).</p>

<h2>Rake Tasks</h2>

<p>Xcoder provides a rake task to assist with make it easier to perform common Xcode project actions from the command-line.</p>

<p>Within your <code>Rakefile</code> add the following:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>xcoder/rake_task</span><span class='tstring_end'>'</span></span>
</code></pre>

<p>Then define your Rake Task:</p>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='op'>::</span><span class='const'>RakeTask</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
</code></pre>

<p>By default this will generate rake tasks within the &#39;xcode&#39; namespace for
all the projects (within the current working directory), all their targets,
and all their configs. This will also generate tasks for all of a projects
schemes as well.</p>

<pre class="code ruby"><code>All names from the project, schemes, targets, and configs are remove
the camel-casing and replacing the cameling with underscores. Spaces
are replaced with dashes (-)
</code></pre>

<p>This will generate rake tasks that appear similar to the following:</p>

<pre class="code ruby"><code>  rake xcode:project-name:targetname:debug:build
  rake xcode:project-name:targetname:debug:clean
  # ...
</code></pre>

<p>You can specify a parameter to change the root rake namespace:</p>

<pre class="code ruby"><code> <span class='const'>Xcode</span><span class='op'>::</span><span class='const'>RakeTask</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='symbol'>:apple</span>

 <span class='comment'># Resulting Rake Tasks:
</span> <span class='comment'># rake apple:project-name:targetname:debug:build
</span> <span class='comment'># rake apple:project-name:targetname:debug:clean
</span> <span class='comment'># ...
</span></code></pre>

<p>You can also supply a block to provide additional configuration to specify the folder to search for projects and the projects that should generate tasks for:</p>

<pre class="code ruby"><code> Xcode::RakeTask.new :hudson do |xcoder|
   xcoder.directory = &quot;projects&quot;
   xcoder.projects = [ &quot;Project Alpha&quot;, &quot;Project Beta&quot; ]
 end

 rake hudson:project-alpha:targetname:debug:build
 # ...
</code></pre>

<h2><a href="https://github.com/guard/guard">Guard</a></h2>

<p>Guard provides the ability to launch commands when files changed. There is a <a href="https://github.com/burtlo/guard-xcoder">guard-xcoder</a> which allows you easily execute build actions whenever your project file changes.</p>

<pre class="code ruby"><code><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_guard'>guard</span>
<span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_guard'>guard</span><span class='op'>-</span><span class='id identifier rubyid_xcoder'>xcoder</span>

<span class='id identifier rubyid_guard'>guard</span> <span class='id identifier rubyid_init'>init</span>
<span class='id identifier rubyid_guard'>guard</span> <span class='id identifier rubyid_init'>init</span> <span class='id identifier rubyid_xcoder'>xcoder</span>
</code></pre>

<p>Afterwards you will need to define the project you want to monitor and the actions that you want to take place when a source files changes within the project file.</p>

<pre class="code ruby"><code><span class='id identifier rubyid_guard'>guard</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>xcoder</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:actions</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='symbol'>:clean</span><span class='comma'>,</span> <span class='symbol'>:build</span><span class='comma'>,</span> <span class='symbol'>:test</span> <span class='rbracket'>]</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_watch'>watch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ProjectName</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_watch'>watch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ProjectName//TargetName</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='kw'>end</span>
</code></pre>

<h2>Manipulating a Project</h2>

<p>Xcoder can also create targets, configurations, and add files. Xcoder could be used to programmatically manipulate or install external sources into a project.</p>

<p>It is important to note that Xcode gets cranky when the Xcode project file is changed by external sources. This usually causes the project and schemes to reset or maybe even cause Xcode to crash. It is often best to close the project before manipulating it with Xcoder.</p>

<h3>Add the source and header file to the project</h3>

<pre class="code ruby"><code># Copy the physical source files into the project path `Vendor/Reachability`
FileUtils.cp_r &quot;examples/Reachability/Vendor&quot;, &quot;spec/TestProject&quot;

source_files = [ 'Vendor/Reachability/Reachability.m' , 'Vendor/Reachability/Reachability.h' ]

# Create and traverse to the group Reachability within the Vendor folder
project.group('Vendor/Reachability') do
 # Create files for each source file defined above
 source_files.each |source| create_file source }
end
</code></pre>

<p>Within the project file the groups in the path are created or found and then file references are added for the two specified source files. Xcoder only updates the logical project file, it does not copy physical files, that is done by the FileUtils.</p>

<h3>Adding source file to the sources build phase of a target</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_source_file'>source_file</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_file'>file</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Vendor/Reachability/Reachability.m</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>

<span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>TestProject</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sources_build_phase'>sources_build_phase</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_add_build_file'>add_build_file</span> <span class='id identifier rubyid_source_file'>source_file</span>
<span class='kw'>end</span>
</code></pre>

<p>Adding source files does not automatically include it in any of the built targets. That is done after you add the source file to the <code>sources_build_phase</code>. First we find the source file reference, select our target and then add it as a build file.</p>

<h3>Adding a System Framework to the project and built in a target</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_cfnetwork_framework'>cfnetwork_framework</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_frameworks_group'>frameworks_group</span><span class='period'>.</span><span class='id identifier rubyid_create_system_framework'>create_system_framework</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>CFNetwork</span><span class='tstring_end'>'</span></span>

<span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>TestProject</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_framework_build_phase'>framework_build_phase</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_add_build_file'>add_build_file</span> <span class='id identifier rubyid_cfnetwork_framework'>cfnetwork_framework</span>
<span class='kw'>end</span>
</code></pre>

<p>The <strong>CFNetwork.framework</strong> is added to the <code>Frameworks</code> group of the project and then added to the frameworks build phase.</p>

<h3>Add additional build phases to a target</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_create_build_phases'>create_build_phases</span> <span class='symbol'>:copy_headers</span><span class='comma'>,</span> <span class='symbol'>:run_script</span>
</code></pre>

<h3>Configure the Release build settings of a target</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_release_config'>release_config</span> <span class='op'>=</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Release</span><span class='tstring_end'>'</span></span>
<span class='id identifier rubyid_release_config'>release_config</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ALWAYS_SEARCH_USER_PATHS</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='kw'>false</span>

<span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Release</span><span class='tstring_end'>'</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_config'>config</span><span class='op'>|</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_always_search_user_paths'>always_search_user_paths</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_architectures'>architectures</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$(ARCHS_STANDARD_32_BIT)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>armv6</span><span class='tstring_end'>'</span></span> <span class='rbracket'>]</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_copy_phase_strip'>copy_phase_strip</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_dead_code_stripping'>dead_code_stripping</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_debug_information_format'>debug_information_format</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>dwarf-with-dsym</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_c_language_standard'>c_language_standard</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>gnu99</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span>
</code></pre>

<p>Configuration settings can be accessed through <code>get</code>, <code>set</code>, and <code>append</code> with their <a href="https://developer.apple.com/library/mac/#documentation/DeveloperTools/Reference/XcodeBuildSettingRef/1-Build_Setting_Reference/build_setting_ref.html#//apple_ref/doc/uid/TP40003931-CH3-SW110">Xcode Build Names</a> or through convenience methods generated for most of the build settings (<code>property_name</code>, <code>property_name=</code>, <code>append_to_property_name</code>). The entire list of property names can be found in the <a href="/rayh/xcoder/blob/master/lib/xcode/configuration.rb">configuration</a>.</p>

<h3>Saving your changes!</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
</code></pre>

<p>The saved file output is slightly different than what you normally see when you view a Xcode project file. Luckily, Xcode will fix the format of the file if you make any small changes to the project that requires it to save.</p>

<h3>More Examples</h3>

<p>Within the <code>specs/integration</code> folder there are more examples.</p>

<h2>Tests</h2>

<p>There are some basic RSpec tests in the project which I suspect /wont/ work on machines without my identity installed.</p>

<p>Currently these tests only assert the basic project file parsing and build code and do not perform file modification tests (e.g. for info plists) or provisioning profile/keychain importing</p>

<h2>Automation and CI (BETA)</h2>

<p>NOTE: This is only available in HEAD, you will need to install this gem from source to get this Buildspec support and the xcoder tool</p>

<p>This stuff is a work-in-progress and is subject to change.</p>

<p>Xcoder provides a simple mechanism to help with automating builds and CI.  First, define a Buildspec file in the root of your project with contents like this:</p>

<pre class="code ruby"><code><span class='comment'># Assumes identity is first in keychain
</span><span class='id identifier rubyid_group'>group</span> <span class='symbol'>:adhoc</span> <span class='kw'>do</span>

  <span class='comment'># Which project/target/config, or workspace/scheme to use
</span>  <span class='id identifier rubyid_use'>use</span> <span class='symbol'>:MyProject</span><span class='comma'>,</span> <span class='symbol'>:target</span> <span class='op'>=&gt;</span> <span class='symbol'>:MyTarget</span><span class='comma'>,</span> <span class='symbol'>:config</span> <span class='op'>=&gt;</span> <span class='symbol'>:Release</span>

  <span class='comment'># The mobile provision that should be used
</span>  <span class='id identifier rubyid_profile'>profile</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Provisioning/MyProject_AdHoc.mobileprovision</span><span class='tstring_end'>'</span></span>

  <span class='comment'># Keychain is option, allows isolation of identities per-project without 
</span>  <span class='comment'># poluting global keychain
</span>  <span class='id identifier rubyid_keychain'>keychain</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Provisioning/build.keychain</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>build</span><span class='tstring_end'>'</span></span>

  <span class='id identifier rubyid_deploy'>deploy</span> <span class='symbol'>:testflight</span><span class='comma'>,</span> 
    <span class='symbol'>:api_token</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>api token</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> 
    <span class='symbol'>:team_token</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>team token</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
    <span class='symbol'>:notify</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span> 
    <span class='symbol'>:lists</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Internal</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span> 
    <span class='symbol'>:notes</span> <span class='op'>=&gt;</span> <span class='backtick'>`</span><span class='tstring_content'>git log -n 1</span><span class='tstring_end'>`</span></span>
<span class='kw'>end</span>
</code></pre>

<p>You can then invoke the project using the xcoder command line:</p>

<pre class="code ruby"><code># Invoke the default task (deploy)
xcoder -r

# Invoke a specific task
xcoder -r adhoc:package

# Get a list of tasks
xcoder -T
</code></pre>

<p>This is a bit of a work-in-progress and an attempt to allow projects to provide a minimal declaration of how thier artifacts should be built and where they should go.  Integration with CI (Jenkins, for example) or just running locally from the command line should be simple.</p>

<h2>Feedback</h2>

<p>Please raise issues if you find defects or have a feature request.</p>
</div></div>
    
    <div id="footer">
  Generated on Thu Aug  8 16:29:28 2013 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.5 (ruby-1.9.3).
</div>

  </body>
</html>